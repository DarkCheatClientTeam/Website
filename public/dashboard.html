<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dashboard - DarkCheatClient</title>
<link rel="stylesheet" href="/style.css">
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<style>
  .dashboard {
    max-width: 1200px;
    margin: auto;
    padding: 20px;
  }
  
  .user-header {
    background: var(--card);
    border-radius: var(--radius);
    padding: 30px;
    margin-bottom: 30px;
    display: flex;
    align-items: center;
    gap: 20px;
  }
  
  .user-avatar-large {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 3px solid var(--accent);
  }
  
  .user-info h2 {
    margin: 0 0 5px 0;
  }
  
  .user-email {
    color: var(--muted);
    margin: 0;
  }
  
  .dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }
  
  .dashboard-card {
    background: var(--card);
    border-radius: var(--radius);
    padding: 25px;
  }
  
  .dashboard-card h3 {
    margin-top: 0;
    color: var(--accent);
  }
  
  .script-code {
    background: var(--bg-soft);
    padding: 15px;
    border-radius: 8px;
    font-family: monospace;
    font-size: 14px;
    margin: 15px 0;
    overflow-x: auto;
  }
  
  .btn-group {
    display: flex;
    gap: 10px;
    margin-top: 20px;
  }
  
  .logout-btn {
    background: rgba(255, 59, 59, 0.1);
    border: 1px solid var(--accent);
    color: var(--accent);
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
  }
  
  .logout-btn:hover {
    background: rgba(255, 59, 59, 0.2);
  }
</style>
</head>
<body>
  <header>
    <div class="logo">
      DarkCheatClient
      <span class="badge">‚ùÑ Dashboard</span>
    </div>
    <a href="/" class="btn btn-outline">Home</a>
  </header>
  
  <div class="dashboard">
    <div id="user-header" class="user-header">
      <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
    </div>
    
    <div class="dashboard-grid">
      <div class="dashboard-card">
        <h3>üéÆ Your Scripts</h3>
        <div class="script-code">
          loadstring(game:HttpGet('https://dccteam.com/main'))()
        </div>
        <button onclick="copyScript('main')" class="btn btn-primary">
          Copy Main Script
        </button>
      </div>
      
      <div class="dashboard-card">
        <h3>üìä Statistics</h3>
        <p>Account created: <span id="account-created">Loading...</span></p>
        <p>Last login: <span id="last-login">Loading...</span></p>
        <p>Scripts used: <strong>24</strong></p>
      </div>
      
      <div class="dashboard-card">
        <h3>‚öôÔ∏è Settings</h3>
        <p>Manage your account settings and preferences.</p>
        <div class="btn-group">
          <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase
    const SUPABASE_URL = 'https://eqzpjvjhnwzmksarkuaj.supabase.co';
    const SUPABASE_ANON_KEY = 'sb_publishable_SxDXhJb_l3BM0v_0jTAJpw_7ijx9O1B';
    
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    async function checkAuth() {
      const { data: { session } } = await supabase.auth.getSession();
      
      if (!session) {
        window.location.href = '/login.html';
        return null;
      }
      
      return session.user;
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    async function loadUserData() {
      const user = await checkAuth();
      if (!user) return;
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
      document.getElementById('user-header').innerHTML = `
        <img src="${user.user_metadata.avatar_url || 'https://cdn.discordapp.com/embed/avatars/0.png'}" 
             class="user-avatar-large"
             onerror="this.src='https://cdn.discordapp.com/embed/avatars/0.png'">
        <div class="user-info">
          <h2>${user.user_metadata.full_name || 'User'}</h2>
          <p class="user-email">${user.email}</p>
          <p>Discord: ${user.user_metadata.preferred_username || 'Not linked'}</p>
        </div>
      `;
      
      // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î
      const { data: userData, error } = await supabase
        .from('users')
        .select('*')
        .eq('id', user.id)
        .single();
        
      if (!error && userData) {
        document.getElementById('account-created').textContent = 
          new Date(userData.created_at).toLocaleDateString();
        document.getElementById('last-login').textContent = 
          new Date(userData.last_login).toLocaleDateString();
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞
    function copyScript(type) {
      const script = type === 'main' 
        ? "loadstring(game:HttpGet('https://dccteam.com/main'))()"
        : "loadstring(game:HttpGet('https://dccteam.com/universal'))()";
      
      navigator.clipboard.writeText(script);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
      alert(`‚úÖ ${type === 'main' ? 'Main' : 'Universal'} script copied to clipboard!`);
    }
    
    // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
    async function logout() {
      await supabase.auth.signOut();
      window.location.href = '/';
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', loadUserData);
  </script>
</body>
  </html>
