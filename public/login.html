<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Login - DarkCheatClient</title>
<style>
  :root {
    --bg: #070707;
    --card: #111;
    --accent: #ff3b3b;
    --text: #f1f1f1;
    --muted: #b0b0b0;
    --radius: 14px;
  }
  
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  
  body {
    background: var(--bg);
    color: var(--text);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  
  .auth-container {
    width: 100%;
    max-width: 420px;
  }
  
  .auth-card {
    background: var(--card);
    border-radius: var(--radius);
    padding: 40px 30px;
    border: 1px solid #222;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  }
  
  .logo {
    font-size: 28px;
    font-weight: 800;
    margin-bottom: 5px;
    background: linear-gradient(90deg, var(--accent), var(--accent-soft));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  
  .subtitle {
    color: var(--muted);
    margin-bottom: 30px;
    font-size: 14px;
  }
  
  .auth-buttons {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 20px;
  }
  
  .auth-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 16px;
    border-radius: 12px;
    border: none;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 16px;
    width: 100%;
  }
  
  .auth-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
  }
  
  .auth-btn:active {
    transform: translateY(0);
  }
  
  .auth-btn.discord {
    background: #5865F2;
    color: white;
  }
  
  .auth-btn.discord:hover {
    background: #4752c4;
  }
  
  .auth-btn.google {
    background: white;
    color: #333;
    border: 1px solid #ddd;
  }
  
  .auth-btn.google:hover {
    background: #f5f5f5;
  }
  
  .back-link {
    display: inline-block;
    margin-top: 20px;
    color: var(--muted);
    text-decoration: none;
    font-size: 14px;
    padding: 8px 16px;
    border-radius: 8px;
    transition: all 0.3s;
  }
  
  .back-link:hover {
    color: var(--accent);
    background: rgba(255, 59, 59, 0.1);
  }
  
  .error {
    color: #ff3b3b;
    background: rgba(255, 59, 59, 0.1);
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 20px;
    font-size: 14px;
    display: none;
    border-left: 4px solid var(--accent);
  }
  
  .loading {
    display: none;
    color: var(--accent);
    margin-top: 10px;
  }
  
  .loading-spinner {
    border: 2px solid rgba(255, 59, 59, 0.3);
    border-radius: 50%;
    border-top: 2px solid var(--accent);
    width: 20px;
    height: 20px;
    animation: spin 1s linear infinite;
    display: inline-block;
    vertical-align: middle;
    margin-right: 10px;
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>
</head>
<body>
  <div class="auth-container">
    <div id="error-message" class="error"></div>
    
    <div class="auth-card">
      <div class="logo">DarkCheatClient</div>
      <div class="subtitle">‚ùÑ Winter Edition - Secure Access</div>
      
      <div class="auth-buttons">
        <button id="discord-btn" class="auth-btn discord">
          <svg width="20" height="20" viewBox="0 0 24 24">
            <path fill="currentColor" d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.791 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028c.462-.63.872-1.295 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128c.125-.094.25-.189.372-.286a.076.076 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.076.076 0 0 1 .078.01c.12.096.245.19.37.285a.077.077 0 0 1-.006.128a12.3 12.3 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.355.698.765 1.363 1.226 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"/>
          </svg>
          Continue with Discord
        </button>
        
        <button id="google-btn" class="auth-btn google">
          <svg width="20" height="20" viewBox="0 0 24 24">
            <path fill="currentColor" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
            <path fill="currentColor" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
            <path fill="currentColor" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
            <path fill="currentColor" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
          </svg>
          Continue with Google
        </button>
      </div>
      
      <div id="loading" class="loading">
        <div class="loading-spinner"></div>
        Redirecting to authentication...
      </div>
      
      <a href="/" class="back-link">‚Üê Back to Home</a>
    </div>
  </div>
  
  <!-- Supabase CDN -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  
  <script>
    // =============== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ===============
    // –ó–ê–ú–ï–ù–ò –≠–¢–ò –ó–ù–ê–ß–ï–ù–ò–Ø –ù–ê –°–í–û–ò –ò–ó SUPABASE!
    const SUPABASE_URL = 'https://eqzpjvjhnwzmksarkuaj.supabase.co';
    const SUPABASE_ANON_KEY = 'sb_publishable_SxDXhJb_l3BM0v_0jTAJpw_7ijx9O1B';
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –ø—É—Å—Ç—ã–µ
    if (SUPABASE_URL.includes('YOUR_PROJECT_ID') || SUPABASE_ANON_KEY.includes('YOUR_ANON_KEY')) {
      showError('Please update Supabase configuration in the code!');
      console.error('‚ùå Supabase credentials not configured!');
    }
    
    // =============== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===============
    let supabase;
    try {
      supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
        auth: {
          autoRefreshToken: true,
          persistSession: true,
          detectSessionInUrl: true
        }
      });
      console.log('‚úÖ Supabase initialized successfully');
    } catch (error) {
      showError('Failed to initialize authentication: ' + error.message);
      console.error('‚ùå Supabase init error:', error);
    }
    
    // =============== –§–£–ù–ö–¶–ò–ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø ===============
    function showError(message) {
      const errorEl = document.getElementById('error-message');
      errorEl.textContent = message;
      errorEl.style.display = 'block';
      console.error('Error:', message);
      
      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
      setTimeout(() => {
        errorEl.style.display = 'none';
      }, 5000);
    }
    
    function showLoading(show) {
      const loadingEl = document.getElementById('loading');
      const discordBtn = document.getElementById('discord-btn');
      const googleBtn = document.getElementById('google-btn');
      
      if (show) {
        loadingEl.style.display = 'block';
        discordBtn.disabled = true;
        googleBtn.disabled = true;
        discordBtn.style.opacity = '0.6';
        googleBtn.style.opacity = '0.6';
      } else {
        loadingEl.style.display = 'none';
        discordBtn.disabled = false;
        googleBtn.disabled = false;
        discordBtn.style.opacity = '1';
        googleBtn.style.opacity = '1';
      }
    }
    
    // =============== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ö–ù–û–ü–û–ö ===============
    async function signInWithDiscord() {
      try {
        console.log('üîÑ Starting Discord OAuth...');
        showLoading(true);
        
        if (!supabase) {
          throw new Error('Supabase not initialized');
        }
        
        // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π URL –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
        const currentUrl = window.location.origin;
        const redirectUrl = `${currentUrl}/auth-callback.html`;
        
        console.log('Redirect URL:', redirectUrl);
        
        const { data, error } = await supabase.auth.signInWithOAuth({
          provider: 'discord',
          options: {
            redirectTo: redirectUrl,
            scopes: 'identify email'
          }
        });
        
        if (error) {
          throw new Error(`Discord auth failed: ${error.message}`);
        }
        
        console.log('‚úÖ Discord OAuth started successfully', data);
        
        // OAuth –Ω–∞—á–Ω–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π:
        if (data.url) {
          window.location.href = data.url;
        }
        
      } catch (error) {
        showLoading(false);
        showError(error.message || 'Failed to connect with Discord');
        console.error('‚ùå Discord auth error:', error);
      }
    }
    
    async function signInWithGoogle() {
      try {
        console.log('üîÑ Starting Google OAuth...');
        showLoading(true);
        
        if (!supabase) {
          throw new Error('Supabase not initialized');
        }
        
        const currentUrl = window.location.origin;
        const redirectUrl = `${currentUrl}/auth-callback.html`;
        
        console.log('Redirect URL:', redirectUrl);
        
        const { data, error } = await supabase.auth.signInWithOAuth({
          provider: 'google',
          options: {
            redirectTo: redirectUrl,
            queryParams: {
              access_type: 'offline',
              prompt: 'consent'
            }
          }
        });
        
        if (error) {
          throw new Error(`Google auth failed: ${error.message}`);
        }
        
        console.log('‚úÖ Google OAuth started successfully', data);
        
        if (data.url) {
          window.location.href = data.url;
        }
        
      } catch (error) {
        showLoading(false);
        showError(error.message || 'Failed to connect with Google');
        console.error('‚ùå Google auth error:', error);
      }
    }
    
    // =============== –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï –°–û–ë–´–¢–ò–ô ===============
    document.addEventListener('DOMContentLoaded', function() {
      console.log('üìÑ Login page loaded');
      
      // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
      const discordBtn = document.getElementById('discord-btn');
      const googleBtn = document.getElementById('google-btn');
      
      if (discordBtn) {
        discordBtn.addEventListener('click', signInWithDiscord);
        console.log('‚úÖ Discord button event listener added');
      } else {
        console.error('‚ùå Discord button not found!');
      }
      
      if (googleBtn) {
        googleBtn.addEventListener('click', signInWithGoogle);
        console.log('‚úÖ Google button event listener added');
      } else {
        console.error('‚ùå Google button not found!');
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º URL –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
      const urlParams = new URLSearchParams(window.location.search);
      const error = urlParams.get('error');
      const errorDescription = urlParams.get('error_description');
      
      if (error) {
        showError(`Authentication error: ${errorDescription || error}`);
        window.history.replaceState({}, document.title, window.location.pathname);
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
      checkCurrentSession();
    });
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é
    async function checkCurrentSession() {
      try {
        if (!supabase) return;
        
        const { data, error } = await supabase.auth.getSession();
        
        if (error) {
          console.log('No active session:', error.message);
          return;
        }
        
        if (data.session) {
          console.log('User already logged in, redirecting...');
          window.location.href = '/';
        }
      } catch (error) {
        console.log('Session check error:', error);
      }
    }
    
    // –î–µ–±–∞–≥ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    window.testAuth = function() {
      console.log('=== DEBUG INFO ===');
      console.log('Supabase URL:', SUPABASE_URL);
      console.log('Current URL:', window.location.href);
      console.log('Origin:', window.location.origin);
      console.log('Supabase instance:', supabase ? '‚úÖ Initialized' : '‚ùå Not initialized');
      
      // –¢–µ—Å—Ç–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Supabase
      if (supabase) {
        supabase.auth.getSession().then(({ data }) => {
          console.log('Current session:', data.session);
        }).catch(err => {
          console.error('Session test error:', err);
        });
      }
    };
    
    // –í—ã–∑–æ–≤ –¥–µ–±–∞–≥ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Ctrl+Shift+D
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey && e.shiftKey && e.key === 'D') {
        window.testAuth();
      }
    });
  </script>
</body>
</html>
